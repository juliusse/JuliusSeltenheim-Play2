@(description: Html, skillGroups: List[services.database.SkillGroup]) 

@import controllers.Application 

@defining(Application.getSessionLang()) { langKey => 
@layout("menu_profile") {
<div>
	@description
	<table class="js profile">
		<tr>
			<th>@Application.messages("skills_area")</th>
			<th style="width: 200px;">@Application.messages("skills_technology")
			</th>
			<th style="text-align: right; width: 140px;">@Application.messages("skills_experience")
			</th>
		</tr>

		@for(skillGroup <- skillGroups) {
		<tr>
			<td>@skillGroup.getName()</td>
			<td>@for(skill <- skillGroup.getSkills()) { 
				@skill.getName()<br> 
				}
				@if(UsersController.isLoggedIn()) {
					<form action="@routes.SkillsController.addSkill(Application.getSessionLang(),skillGroup.getId())" method="POST">
					<input name="name" placeholder="Name"><br>
					<button type="submit">Hinzufügen</button>
				</form>
				}
			</td>
			<td style="text-align: right; padding-bottom: 10px;">
			@for(skill <- skillGroup.getSkills()) { 
				<div id="empty-@langKey-@skillGroup.getId()-@skill.getName()" class="emptyStars"></div>
				<div id="full-@langKey-@skillGroup.getId()-@skill.getName()" class="fullStars" style="width:@(skill.getKnowledge()* 120)px;"></div><br>
				
				}
			</td>
		</tr>
		}
		@if(UsersController.isLoggedIn()) {
		<tr>
			<td>
				<form action="@routes.SkillsController.addSkillGroup(Application.getSessionLang())" method="POST">
					<input name="nameDe" placeholder="Deutscher Titel"><br>
					<input name="nameEn" placeholder="Englischer Titel"><br>
					<button type="submit">Hinzufügen</button>
				</form>
			</td>
		</tr>
		}
	</table>
</div>

@if(UsersController.isLoggedIn()) {
<script type="text/javascript">
$('.emptyStars').click(function(e) {
	var posX = $(this).offset().left;
	updateKnowledge($(this).attr("id"), (e.pageX - posX)/120.0);
});

$('.fullStars').click(function(e) {
	var posX = $(this).offset().left;
	updateKnowledge($(this).attr("id"), (e.pageX - posX)/120.0);
});

var updateKnowledge = function(id, value) {
	var langKey, skillGroupId, skillName;
	var parts = id.split("-");
	langKey = parts[1];
	skillGroupId = parts[2];
	skillName = parts[3];
	
	$.ajax({
		  type: "POST",
		  url: "/"+langKey+"/skillgroup/"+skillGroupId+"/"+encodeURIComponent(skillName)+"/setLevel",
		  data: "level="+value,
		  success: function() {location.reload();},
		});
} 
</script>
}

} }
