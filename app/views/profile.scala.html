@(employments: List[services.database.Employment], educations: List[services.database.Education])

@import controllers.Application
@import services.database._
@import helper._

@defining(Application.getSessionLang()) { langKey =>


@layout("menu_profile") {

<div id="profileContainer">
	<div class="profileTimelineContainer">
		<div id="timeline" style="float:left;width: 50px;position: absolute; height: 98%;top:20px;"></div>
	</div>

	<div class="profileListingContainer">
		<h2>@Application.messages("menu_employment")</h2>
		@if(controllers.UsersController.isLoggedIn()) {
		<div class="employmentCard">
		@form(routes.ProfileController.upsertEmployment(langKey)) {
			<h3>New Employment</h3>
			<input name="titleDe" placeholder="German Title"> | <input name="titleEn" placeholder="English Title"><br>
			<span class="sosa">o</span>
			<input name="place" placeholder="where">
			<input name="website" placeholder="website"><br>
			<span class="sosa">[</span>
			<input name="fromDate" placeholder="yyyy-mm-dd"> - <input name="toDate" placeholder="yyyy-mm-dd">
			<br><br>
			<textarea rows="5" cols="20" name="tasksDe" placeholder="One Task per row (German)"></textarea>
			<textarea rows="5" cols="20" name="tasksEn" placeholder="One Task per row (English)"></textarea><br>	
			<button type="submit" name="create">Create</button>
        }
		</div>
		}
		@for(employment <- employments) {
			<div id="@employment.getId()" class="employmentCard">
				<h3>@employment.getTitle()</h3>
				<span class="sosa">o</span> 
				@if(employment.getWebsite().isEmpty()) {
					@employment.getPlace()
				} else {
					<a target="_blank" href="@employment.getWebsite()">@employment.getPlace()</a>
				}<br>
				<span class="sosa">[</span>
				@employment.getFromDate().toString("MMM yyyy",Application.getCurrentLocale()) - 
	            @if(employment.getToDate() != null) {
	            	@employment.getToDate().toString("MMM yyyy",Application.getCurrentLocale())
	            } else {
	            	@Application.messages("ongoing")
	            }<br><br>
	            @for(task <- employment.getTasks()) {
	            <div class="employmentDuty">
	            	<span class="sosa">Ã±</span> @task
	            </div>	            
	            }
			</div>
		}

	    <h2> @Application.messages("menu_education")</h2>
	    @if(controllers.UsersController.isLoggedIn()) {
	    <div class="employmentCard">
		@form(routes.ProfileController.upsertEducation(langKey)) {
			<h3>New Education</h3>
			<input name="titleDe" placeholder="German Title"> | <input name="titleEn" placeholder="English Title"><br>
			<input name="degreeDe" placeholder="German Degree"> | <input name="degreeEn" placeholder="English Degree"><br>
			<span class="sosa">o</span>
			<input name="place" placeholder="where">
			<input name="website" placeholder="website"><br>
			<span class="sosa">[</span>
			<input name="fromDate" placeholder="yyyy-mm-dd"> - <input name="toDate" placeholder="yyyy-mm-dd"><br>
			<span class="sosa">G</span>
			<input name="score" placeholder="score"><br>	
			<button type="submit" name="create">Create</button>
        }
		</div>
		}
	   	@for(education <- educations) {
			<div id="@education.getId()" class="employmentCard">
				<h3>@education.getDegree()</h3>
				<span class="sosa">o</span> 
				@if(education.getWebsite().isEmpty()) {
					@education.getPlace()
				} else {
					<a target="_blank" href="@education.getWebsite()">@education.getPlace()</a>
				}<br>
				<span class="sosa">[</span> 
				@education.getFromDate().getYear() - 
	            @if(education.getToDate() != null) {
	            	@education.getToDate().getYear()
	            } else {
	            	@Application.messages("ongoing")
	            }<br>
				<span class="sosa">G</span> @education.getScore()
			</div>
		}
	</div>
</div> 

<script type="text/javascript">
	var eduEntryData = [
	["undefined",new Date(2009,1,1),new Date(2009,1,1)]
	@for(education <- educations) {
		@if(education.getToDate() != null) {
			,["@education.getPlace() - @education.getDegree()",new Date(@education.getFromDate().getMillis()),new Date(@education.getToDate().getMillis()),"@education.getId()"]
		} else {
			,["@education.getPlace() - @education.getDegree()",new Date(@education.getFromDate().getMillis()),new Date(),"@education.getId()"]
		}
	}
	];
	
	var emplEntryData = [
	                	["undefined",new Date(2009,1,1),new Date(2009,1,1),"idForHighlighting"]

	                	@for(employment <- employments) {
	                		@if(employment.getToDate != null) {
	                		,["@employment.getPlace() - @employment.getTitle()",new Date(@employment.getFromDate().getMillis()),new Date(@employment.getToDate().getMillis()),"@employment.getId()"]
	                		} else {
	                			,["@employment.getPlace() - @employment.getTitle()",new Date(@employment.getFromDate().getMillis()),new Date(),"@employment.getId()"]	
	                		}
	                	}
	                	];
	
	var profileContainer = document.getElementById("profileContainer");
	profileContainer.style.height = (profileContainer.clientHeight) +"px";
	
	var timeline = new Timeline(document.getElementById("timeline"),2008)
	for(index in eduEntryData) {
		if(index == 0) {
			continue;
		}
		var entryData = eduEntryData[index];
		var timelineEntry = new TimelineEntry(entryData[0],entryData[1],entryData[2],'bfe5bf');
		timeline.addTimelineEntry(timelineEntry);
		timelineEntry.addHTMLElementToTriggerHover(document.getElementById(entryData[3]));
	}
	
	for(index in emplEntryData) {
		if(index == 0) {
			continue;
		}
		var entryData = emplEntryData[index];
		var timelineEntry = new TimelineEntry(entryData[0],entryData[1],entryData[2],'fad8c7');
		timeline.addTimelineEntry(timelineEntry);
		timelineEntry.addHTMLElementToTriggerHover(document.getElementById(entryData[3]));
	}
</script> 

}
}